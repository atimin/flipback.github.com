
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>NMatrix 0.2.0 and slicing - Flipback&#8217;s blog</title>
	<meta name="author" content="Aleksey Timin">

	
	<meta name="description" content="A few days ago the new version of NMatrix has been released. Besides a lot new features it has slicing operations now. The slicing has been &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Flipback's blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<body>
	<header id="header" class="inner"><h1><a href="/">Flipback&#8217;s blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="http://flip-cherdak.blogspot.com/">Old blog</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="http://flip-cherdak.blogspot.com/">Old blog</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:blog.flipback.net">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/100647047226011286297?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/aleksey_timin" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/flipback" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:blog.flipback.net">
	</form>
</nav>

</header>
	
		
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/aleksey_timin">aleksey_timin</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading&#8230;</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('aleksey_timin', 4, true);
	})(jQuery);
</script>

	
	<div id="content" class="inner"><article class="post">
	<h1 class="title">NMatrix 0.2.0 and Slicing</h1>
	<div class="entry-content"><p>A few days ago the <a href="http://sciruby.com/blog/2012/09/24/second-nmatrix-alpha-released/">new version</a> of NMatrix has been released. Besides a lot new features it has slicing operations now. The slicing has been implemented by two ways. First of they it&rsquo;s a slicing by reference. It is provided by <strong>#[]</strong> method:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s2">&quot;nmatrix&quot;</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;pp&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Create dense matrix with size [3,3] and fill it.</span>
</span><span class='line'><span class="n">m</span> <span class="o">=</span> <span class="no">NMatrix</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:dense</span><span class="p">,</span> <span class="o">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="p">)</span>
</span><span class='line'><span class="n">r</span> <span class="o">=</span> <span class="n">m</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">2</span><span class="o">]</span> <span class="c1">#=&gt; [1,2] [4,5]</span>
</span><span class='line'><span class="n">r</span><span class="o">.</span><span class="n">is_ref?</span>         <span class="c1">#=&gt; true</span>
</span><span class='line'>
</span><span class='line'><span class="n">r</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">999</span>
</span><span class='line'>
</span><span class='line'><span class="n">pp</span> <span class="n">r</span>              <span class="c1">#=&gt; [999,2] [4,5]</span>
</span><span class='line'><span class="n">pp</span> <span class="n">m</span>              <span class="c1">#=&gt; [0,999,2] [3,4,5] [6,7,8]</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you see both matrices has been changed when we assign a new value to element of <em>r</em> matrix. The <strong>#[]</strong> method doesn&rsquo;t allocate memory,  but creates a new matrix with reference to a base matrix <em>m</em>. You can build chain of the same slicing and all of new matrices will be references for one base.</p>

<!-- MORE -->


<p></p>

<p><strong>Note:</strong> The NMatrix uses ATLAS for multiplication, which surely cannot work with references. And so when you try to multiply references they will be copped to temporary matrices before multiplication. Remember it using a big data. Also it is for several operations such as a casting.</p>

<p>Second method of slicing by copying is <strong>#slice</strong>. This method allocates memory for the slice and copies all elements from the base matrix. Example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s2">&quot;nmatrix&quot;</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;pp&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Create dense matrix with size [3,3] and fill it.</span>
</span><span class='line'><span class="n">m</span> <span class="o">=</span> <span class="no">NMatrix</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:dense</span><span class="p">,</span> <span class="o">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">r</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#=&gt; [1,2] [4,5]</span>
</span><span class='line'><span class="n">r</span><span class="o">.</span><span class="n">is_ref?</span>         <span class="c1">#=&gt; false</span>
</span><span class='line'>
</span><span class='line'><span class="n">r</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">999</span>
</span><span class='line'>
</span><span class='line'><span class="n">pp</span> <span class="n">r</span>              <span class="c1">#=&gt; [999,2] [4,5]</span>
</span><span class='line'><span class="n">pp</span> <span class="n">m</span>              <span class="c1">#=&gt; [0,1,2] [3,4,5] [6,7,8]</span>
</span></code></pre></td></tr></table></div></figure>


<p>This time the <em>r</em> matrix is an independent object. All changes of it doesn&rsquo;t concern the base matrix and you can use it as an usual matrix.</p>

<p>I ought to remind that the slicing operations are pretty raw. Will be careful to use it. If you have a bug, feel free to report about it <a href="https://github.com/SciRuby/nmatrix/issues?direction=desc&amp;milestone=2&amp;sort=created&amp;state=open">here</a>.</p>

<p>Thanks, Aleksey.</p>
</div>


<div class="meta">
	<div class="date">




<time class='entry-date' datetime='2012-09-30T19:43:00+06:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>7:43 pm</span></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/english/'>english</a>, <a class='category' href='/blog/categories/math/'>math</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
		<span class="comments"><a href="/blog/2012/09/30/nmatrix-0-dot-2-0-and-slicing/#disqus_thread">Comments</a></span>
	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Flipback's blog -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-5818326126921980"
     data-ad-slot="7071523091"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Aleksey Timin

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'flpbacksblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.flipback.net/blog/2012/09/30/nmatrix-0-dot-2-0-and-slicing/';
        var disqus_url = 'http://blog.flipback.net/blog/2012/09/30/nmatrix-0-dot-2-0-and-slicing/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-10108623-4']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
